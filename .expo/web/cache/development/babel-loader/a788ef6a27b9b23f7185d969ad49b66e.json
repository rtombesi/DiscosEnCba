{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar _jsxFileName = \"D:\\\\Proyecto discos-cba\\\\app\\\\components\\\\account\\\\InfoUser.js\";\nimport React from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Avatar } from \"react-native-elements\";\nimport * as firebase from \"firebase\";\nimport * as Permissions from \"expo-permissions\";\nimport * as ImagePicker from \"expo-image-picker\";\nexport default function InfoUser(props) {\n  var _props$userInfo = props.userInfo,\n      uid = _props$userInfo.uid,\n      photoURL = _props$userInfo.photoURL,\n      displayName = _props$userInfo.displayName,\n      email = _props$userInfo.email,\n      toastRef = props.toastRef,\n      setloading = props.setloading,\n      setloadingText = props.setloadingText;\n\n  var changeAvatar = function changeAvatar() {\n    var resultPermissions, resultPermissionCamera, result;\n    return _regeneratorRuntime.async(function changeAvatar$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n          case 2:\n            resultPermissions = _context.sent;\n            resultPermissionCamera = resultPermissions.permissions.cameraRoll.status;\n\n            if (!(resultPermissionCamera === \"denied\")) {\n              _context.next = 8;\n              break;\n            }\n\n            toastRef.current.show(\"Debe aceptar los permisos de la galería\");\n            _context.next = 12;\n            break;\n\n          case 8:\n            _context.next = 10;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              allowsEditing: true,\n              aspect: [4, 3]\n            }));\n\n          case 10:\n            result = _context.sent;\n\n            if (result.cancelled) {\n              toastRef.current.show(\"Cerraste la selección de imagenes\");\n            } else {\n              upLoadImage(result.uri).then(function () {\n                upDatePhotoUrl();\n              }).catch(function (error) {\n                console.log(error);\n                toastRef.current.show(\"Error al subir el avatar\");\n              });\n            }\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var upLoadImage = function upLoadImage(uri) {\n    var response, blob, ref;\n    return _regeneratorRuntime.async(function upLoadImage$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setloadingText(\"Modificando Avatar\");\n            setloading(true);\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 4:\n            response = _context2.sent;\n            _context2.next = 7;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 7:\n            blob = _context2.sent;\n            ref = firebase.storage().ref().child(\"avatar/\" + uid);\n            return _context2.abrupt(\"return\", ref.put(blob));\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var upDatePhotoUrl = function upDatePhotoUrl() {\n    firebase.storage().ref(\"avatar/\" + uid).getDownloadURL().then(function _callee(response) {\n      var update;\n      return _regeneratorRuntime.async(function _callee$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              update = {\n                photoURL: response\n              };\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(firebase.auth().currentUser.updateProfile(update));\n\n            case 3:\n              setloading(false);\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }).catch(function () {\n      toastRef.current.show(\"Error al actualizar el avatar\");\n    });\n  };\n\n  return React.createElement(View, {\n    style: styles.viewUserInfo,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }, React.createElement(Avatar, {\n    rounded: true,\n    size: \"large\",\n    showAccessory: true,\n    onAccessoryPress: changeAvatar,\n    containerStyle: styles.userInfoAvatar,\n    source: photoURL ? {\n      uri: photoURL\n    } : require(\"../../../assets/img/avatar-default.jpg\"),\n    useNativeDriver: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.displayName,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, displayName ? displayName : \"Anónimo\"), React.createElement(Text, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, email ? email : \"Facebook Login\")));\n}\nvar styles = StyleSheet.create({\n  viewUserInfo: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    flexDirection: \"row\",\n    backgroundColor: \"#f2f2f2\",\n    paddingTop: 30,\n    paddingBottom: 30\n  },\n  userInfoAvatar: {\n    marginRight: 20\n  },\n  displayName: {\n    fontWeight: \"bold\",\n    paddingBottom: 5\n  }\n});","map":{"version":3,"sources":["D:/Proyecto discos-cba/app/components/account/InfoUser.js"],"names":["React","Avatar","firebase","Permissions","ImagePicker","InfoUser","props","userInfo","uid","photoURL","displayName","email","toastRef","setloading","setloadingText","changeAvatar","askAsync","CAMERA_ROLL","resultPermissions","resultPermissionCamera","permissions","cameraRoll","status","current","show","launchImageLibraryAsync","allowsEditing","aspect","result","cancelled","upLoadImage","uri","then","upDatePhotoUrl","catch","error","console","log","fetch","response","blob","ref","storage","child","put","getDownloadURL","update","auth","currentUser","updateProfile","styles","viewUserInfo","userInfoAvatar","require","StyleSheet","create","alignItems","justifyContent","flexDirection","backgroundColor","paddingTop","paddingBottom","marginRight","fontWeight"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Text, View, StyleSheet } from \"react-native\";\r\nimport { Avatar } from \"react-native-elements\";\r\nimport * as firebase from \"firebase\";\r\nimport * as Permissions from \"expo-permissions\";\r\nimport * as ImagePicker from \"expo-image-picker\";\r\n\r\nexport default function InfoUser(props) {\r\n  const {\r\n    userInfo: { uid, photoURL, displayName, email },\r\n    toastRef,\r\n    setloading,\r\n    setloadingText,\r\n  } = props;\r\n\r\n  const changeAvatar = async () => {\r\n    const resultPermissions = await Permissions.askAsync(\r\n      Permissions.CAMERA_ROLL\r\n    );\r\n    const resultPermissionCamera =\r\n      resultPermissions.permissions.cameraRoll.status;\r\n\r\n    if (resultPermissionCamera === \"denied\") {\r\n      toastRef.current.show(\"Debe aceptar los permisos de la galería\");\r\n    } else {\r\n      const result = await ImagePicker.launchImageLibraryAsync({\r\n        allowsEditing: true,\r\n        aspect: [4, 3],\r\n      });\r\n\r\n      if (result.cancelled) {\r\n        toastRef.current.show(\"Cerraste la selección de imagenes\");\r\n      } else {\r\n        upLoadImage(result.uri)\r\n          .then(() => {\r\n            upDatePhotoUrl();\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n            toastRef.current.show(\"Error al subir el avatar\");\r\n          });\r\n      }\r\n    }\r\n  };\r\n\r\n  const upLoadImage = async (uri) => {\r\n    setloadingText(\"Modificando Avatar\");\r\n    setloading(true);\r\n\r\n    const response = await fetch(uri);\r\n    const blob = await response.blob();\r\n\r\n    const ref = firebase.storage().ref().child(`avatar/${uid}`);\r\n    return ref.put(blob);\r\n  };\r\n\r\n  const upDatePhotoUrl = () => {\r\n    firebase\r\n      .storage()\r\n      .ref(`avatar/${uid}`)\r\n      .getDownloadURL()\r\n      .then(async (response) => {\r\n        const update = {\r\n          photoURL: response,\r\n        };\r\n        await firebase.auth().currentUser.updateProfile(update);\r\n        setloading(false);\r\n      })\r\n      .catch(() => {\r\n        toastRef.current.show(\"Error al actualizar el avatar\");\r\n      });\r\n  };\r\n\r\n  return (\r\n    <View style={styles.viewUserInfo}>\r\n      <Avatar\r\n        rounded\r\n        size=\"large\"\r\n        showAccessory\r\n        onAccessoryPress={changeAvatar}\r\n        containerStyle={styles.userInfoAvatar}\r\n        source={\r\n          photoURL\r\n            ? { uri: photoURL }\r\n            : require(\"../../../assets/img/avatar-default.jpg\")\r\n        }\r\n        useNativeDriver={true}\r\n      />\r\n      <View>\r\n        <Text style={styles.displayName}>\r\n          {displayName ? displayName : \"Anónimo\"}\r\n        </Text>\r\n        <Text>{email ? email : \"Facebook Login\"}</Text>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  viewUserInfo: {\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    flexDirection: \"row\",\r\n    backgroundColor: \"#f2f2f2\",\r\n    paddingTop: 30,\r\n    paddingBottom: 30,\r\n  },\r\n  userInfoAvatar: {\r\n    marginRight: 20,\r\n  },\r\n  displayName: {\r\n    fontWeight: \"bold\",\r\n    paddingBottom: 5,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}