{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\Proyecto discos-cba\\\\app\\\\screens\\\\Vinilos\\\\Vinilos.js\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { Icon } from \"react-native-elements\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { firebaseApp } from \"../../utils/firebase\";\nimport firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport ListVinilos from \"../../components/Vinilos/ListVinilos\";\nvar db = firebase.firestore(firebaseApp);\nvar db1 = firebase.firestore(firebaseApp);\nexport default function Vinilos(props) {\n  var navigation = props.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      vinilos = _useState4[0],\n      setVinilos = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      totalVinilos = _useState6[0],\n      settotalVinilos = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      startVinilos = _useState8[0],\n      setStartVinilos = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      isLoading = _useState10[0],\n      setIsLoading = _useState10[1];\n\n  var limitVinilos = 10;\n  useEffect(function () {\n    firebase.auth().onAuthStateChanged(function (useInfo) {\n      var useradmin = [];\n      db1.collection(\"useradmin\").get().then(function (response) {\n        response.forEach(function (doc) {\n          var usradmin = doc.data();\n          useradmin.push(usradmin);\n        });\n        useradmin.forEach(function (element) {\n          if (element.useruid == useInfo.uid) {\n            setUser(useInfo);\n          } else {\n            setUser(null);\n          }\n        });\n      });\n    });\n  }, []);\n  useFocusEffect(useCallback(function () {\n    db.collection(\"vinilos\").get().then(function (snap) {\n      settotalVinilos(snap.size);\n    });\n    var resultVinilos = [];\n    db.collection(\"vinilos\").orderBy(\"createAt\", \"desc\").limit(limitVinilos).get().then(function (response) {\n      setStartVinilos(response.docs[response.docs.length - 1]);\n      response.forEach(function (doc) {\n        var vinilo = doc.data();\n        vinilo.id = doc.id;\n        resultVinilos.push(vinilo);\n      });\n      setVinilos(resultVinilos);\n    });\n  }, []));\n\n  var handleLoadMore = function handleLoadMore() {\n    var resultVinilos = [];\n    vinilos.length < totalVinilos && setIsLoading(true);\n    db.collection(\"vinilos\").orderBy(\"createAt\", \"desc\").startAfter(startVinilos.data().createAt).limit(limitVinilos).get().then(function (response) {\n      if (response.docs.length > 0) {\n        setStartVinilos(response.docs[response.docs.length - 1]);\n      } else {\n        setIsLoading(false);\n      }\n\n      response.forEach(function (doc) {\n        var vinilo = doc.data();\n        vinilo.id = doc.id;\n        resultVinilos.push(vinilo);\n      });\n      setVinilos([].concat(_toConsumableArray(vinilos), resultVinilos));\n    });\n  };\n\n  return React.createElement(View, {\n    style: styles.viewBody,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }\n  }, React.createElement(ListVinilos, {\n    vinilos: vinilos,\n    handleLoadMore: handleLoadMore,\n    isLoading: isLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }), user && React.createElement(Icon, {\n    reverse: true,\n    type: \"material-community\",\n    name: \"plus\",\n    color: \"#ea4d14fa\",\n    containerStyle: styles.btnContainer,\n    onPress: function onPress() {\n      return navigation.navigate(\"add-vinilo\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }));\n}\nvar styles = StyleSheet.create({\n  viewBody: {\n    flex: 1,\n    backgroundColor: \"#fff\"\n  },\n  btnContainer: {\n    position: \"absolute\",\n    bottom: 10,\n    right: 10,\n    shadowColor: \"black\",\n    shadowOffset: {\n      width: 4,\n      height: 4\n    },\n    shadowOpacity: 0.2\n  }\n});","map":{"version":3,"sources":["D:/Proyecto discos-cba/app/screens/Vinilos/Vinilos.js"],"names":["React","useState","useEffect","useCallback","Icon","useFocusEffect","firebaseApp","firebase","ListVinilos","db","firestore","db1","Vinilos","props","navigation","user","setUser","vinilos","setVinilos","totalVinilos","settotalVinilos","startVinilos","setStartVinilos","isLoading","setIsLoading","limitVinilos","auth","onAuthStateChanged","useInfo","useradmin","collection","get","then","response","forEach","doc","usradmin","data","push","element","useruid","uid","snap","size","resultVinilos","orderBy","limit","docs","length","vinilo","id","handleLoadMore","startAfter","createAt","styles","viewBody","btnContainer","navigate","StyleSheet","create","flex","backgroundColor","position","bottom","right","shadowColor","shadowOffset","width","height","shadowOpacity"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { StyleSheet, View, Text } from \"react-native\";\r\nimport { Icon } from \"react-native-elements\";\r\nimport { useFocusEffect } from \"@react-navigation/native\";\r\nimport { firebaseApp } from \"../../utils/firebase\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport ListVinilos from \"../../components/Vinilos/ListVinilos\";\r\n\r\nconst db = firebase.firestore(firebaseApp);\r\nconst db1 = firebase.firestore(firebaseApp);\r\n\r\nexport default function Vinilos(props) {\r\n  const { navigation } = props;\r\n  const [user, setUser] = useState(null);\r\n  const [vinilos, setVinilos] = useState([]);\r\n  const [totalVinilos, settotalVinilos] = useState(0);\r\n  const [startVinilos, setStartVinilos] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const limitVinilos = 10;\r\n\r\n  useEffect(() => {\r\n    firebase.auth().onAuthStateChanged((useInfo) => {\r\n      const useradmin = [];\r\n      db1\r\n        .collection(\"useradmin\")\r\n        .get()\r\n        .then((response) => {\r\n          response.forEach((doc) => {\r\n            const usradmin = doc.data();\r\n            useradmin.push(usradmin);\r\n          });\r\n          useradmin.forEach((element) => {\r\n            if (element.useruid == useInfo.uid) {\r\n              setUser(useInfo);\r\n            } else {\r\n              setUser(null);\r\n            }\r\n          });\r\n        });\r\n    });\r\n  }, []);\r\n\r\n  useFocusEffect(\r\n    useCallback(() => {\r\n      db.collection(\"vinilos\")\r\n        .get()\r\n        .then((snap) => {\r\n          settotalVinilos(snap.size);\r\n        });\r\n      const resultVinilos = [];\r\n\r\n      db.collection(\"vinilos\")\r\n        .orderBy(\"createAt\", \"desc\")\r\n        .limit(limitVinilos)\r\n        .get()\r\n        .then((response) => {\r\n          setStartVinilos(response.docs[response.docs.length - 1]);\r\n\r\n          response.forEach((doc) => {\r\n            const vinilo = doc.data();\r\n            vinilo.id = doc.id;\r\n            resultVinilos.push(vinilo);\r\n          });\r\n          setVinilos(resultVinilos);\r\n        });\r\n    }, [])\r\n  );\r\n\r\n  const handleLoadMore = () => {\r\n    const resultVinilos = [];\r\n    vinilos.length < totalVinilos && setIsLoading(true);\r\n\r\n    db.collection(\"vinilos\")\r\n      .orderBy(\"createAt\", \"desc\")\r\n      .startAfter(startVinilos.data().createAt)\r\n      .limit(limitVinilos)\r\n      .get()\r\n      .then((response) => {\r\n        if (response.docs.length > 0) {\r\n          setStartVinilos(response.docs[response.docs.length - 1]);\r\n        } else {\r\n          setIsLoading(false);\r\n        }\r\n\r\n        response.forEach((doc) => {\r\n          const vinilo = doc.data();\r\n          vinilo.id = doc.id;\r\n          resultVinilos.push(vinilo);\r\n        });\r\n\r\n        setVinilos([...vinilos, ...resultVinilos]);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <View style={styles.viewBody}>\r\n      <ListVinilos\r\n        vinilos={vinilos}\r\n        handleLoadMore={handleLoadMore}\r\n        isLoading={isLoading}\r\n      />\r\n\r\n      {user && (\r\n        <Icon\r\n          reverse\r\n          type=\"material-community\"\r\n          name=\"plus\"\r\n          color=\"#ea4d14fa\"\r\n          containerStyle={styles.btnContainer}\r\n          onPress={() => navigation.navigate(\"add-vinilo\")}\r\n        />\r\n      )}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  viewBody: {\r\n    flex: 1,\r\n    backgroundColor: \"#fff\",\r\n  },\r\n  btnContainer: {\r\n    position: \"absolute\",\r\n    bottom: 10,\r\n    right: 10,\r\n    shadowColor: \"black\",\r\n    shadowOffset: { width: 4, height: 4 },\r\n    shadowOpacity: 0.2,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}