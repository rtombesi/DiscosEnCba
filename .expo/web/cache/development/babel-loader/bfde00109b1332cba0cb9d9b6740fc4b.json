{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\Proyecto discos-cba\\\\app\\\\screens\\\\Cds\\\\Cds.js\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { Icon } from \"react-native-elements\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { firebaseApp } from \"../../utils/firebase\";\nimport firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport ListCds from \"../../components/Cds/ListCds\";\nvar db = firebase.firestore(firebaseApp);\nvar db1 = firebase.firestore(firebaseApp);\nexport default function Cds(props) {\n  var navigation = props.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cds = _useState4[0],\n      setCds = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      totalCds = _useState6[0],\n      settotalCds = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      startCds = _useState8[0],\n      setStartCds = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      isLoading = _useState10[0],\n      setIsLoading = _useState10[1];\n\n  var limitCds = 10;\n  useEffect(function () {\n    firebase.auth().onAuthStateChanged(function (useInfo) {\n      var useradmin = [];\n      db1.collection(\"useradmin\").get().then(function (response) {\n        response.forEach(function (doc) {\n          var usradmin = doc.data();\n          useradmin.push(usradmin);\n        });\n        useradmin.forEach(function (element) {\n          if (element.useruid == useInfo.uid) {\n            setUser(useInfo);\n          } else {\n            setUser(null);\n          }\n        });\n      });\n    });\n  }, []);\n  useFocusEffect(useCallback(function () {\n    db.collection(\"cds\").get().then(function (snap) {\n      settotalCds(snap.size);\n    });\n    var resultCds = [];\n    db.collection(\"cds\").orderBy(\"createAt\", \"desc\").limit(limitCds).get().then(function (response) {\n      setStartCds(response.docs[response.docs.length - 1]);\n      response.forEach(function (doc) {\n        var cd = doc.data();\n        cd.id = doc.id;\n        resultCds.push(cd);\n      });\n      setCds(resultCds);\n    });\n  }, []));\n\n  var handleLoadMore = function handleLoadMore() {\n    var resultCds = [];\n    cds.length < totalCds && setIsLoading(true);\n    db.collection(\"cds\").orderBy(\"createAt\", \"desc\").startAfter(startCds.data().createAt).limit(limitCds).get().then(function (response) {\n      if (response.docs.length > 0) {\n        setStartCds(response.docs[response.docs.length - 1]);\n      } else {\n        setIsLoading(false);\n      }\n\n      response.forEach(function (doc) {\n        var cd = doc.data();\n        cd.id = doc.id;\n        resultCds.push(cd);\n      });\n      setCds([].concat(_toConsumableArray(cds), resultCds));\n    });\n  };\n\n  return React.createElement(View, {\n    style: styles.viewBody,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }\n  }, React.createElement(ListCds, {\n    cds: cds,\n    handleLoadMore: handleLoadMore,\n    isLoading: isLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }), user && React.createElement(Icon, {\n    reverse: true,\n    type: \"material-community\",\n    name: \"plus\",\n    color: \"#ea4d14fa\",\n    containerStyle: styles.btnContainer,\n    onPress: function onPress() {\n      return navigation.navigate(\"add-cd\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }));\n}\nvar styles = StyleSheet.create({\n  viewBody: {\n    flex: 1,\n    backgroundColor: \"#fff\"\n  },\n  btnContainer: {\n    position: \"absolute\",\n    bottom: 10,\n    right: 10,\n    shadowColor: \"black\",\n    shadowOffset: {\n      width: 4,\n      height: 4\n    },\n    shadowOpacity: 0.2\n  }\n});","map":{"version":3,"sources":["D:/Proyecto discos-cba/app/screens/Cds/Cds.js"],"names":["React","useState","useEffect","useCallback","Icon","useFocusEffect","firebaseApp","firebase","ListCds","db","firestore","db1","Cds","props","navigation","user","setUser","cds","setCds","totalCds","settotalCds","startCds","setStartCds","isLoading","setIsLoading","limitCds","auth","onAuthStateChanged","useInfo","useradmin","collection","get","then","response","forEach","doc","usradmin","data","push","element","useruid","uid","snap","size","resultCds","orderBy","limit","docs","length","cd","id","handleLoadMore","startAfter","createAt","styles","viewBody","btnContainer","navigate","StyleSheet","create","flex","backgroundColor","position","bottom","right","shadowColor","shadowOffset","width","height","shadowOpacity"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,WAArC,QAAwD,OAAxD;;;;AAEA,SAASC,IAAT,QAAqB,uBAArB;AACA,SAASC,cAAT,QAA+B,0BAA/B;AACA,SAASC,WAAT;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAO,oBAAP;AACA,OAAOC,OAAP;AAEA,IAAMC,EAAE,GAAGF,QAAQ,CAACG,SAAT,CAAmBJ,WAAnB,CAAX;AACA,IAAMK,GAAG,GAAGJ,QAAQ,CAACG,SAAT,CAAmBJ,WAAnB,CAAZ;AAEA,eAAe,SAASM,GAAT,CAAaC,KAAb,EAAoB;AAAA,MACzBC,UADyB,GACVD,KADU,CACzBC,UADyB;;AAAA,kBAETb,QAAQ,CAAC,IAAD,CAFC;AAAA;AAAA,MAE1Bc,IAF0B;AAAA,MAEpBC,OAFoB;;AAAA,mBAGXf,QAAQ,CAAC,EAAD,CAHG;AAAA;AAAA,MAG1BgB,GAH0B;AAAA,MAGrBC,MAHqB;;AAAA,mBAIDjB,QAAQ,CAAC,CAAD,CAJP;AAAA;AAAA,MAI1BkB,QAJ0B;AAAA,MAIhBC,WAJgB;;AAAA,mBAKDnB,QAAQ,CAAC,IAAD,CALP;AAAA;AAAA,MAK1BoB,QAL0B;AAAA,MAKhBC,WALgB;;AAAA,mBAMCrB,QAAQ,CAAC,KAAD,CANT;AAAA;AAAA,MAM1BsB,SAN0B;AAAA,MAMfC,YANe;;AAOjC,MAAMC,QAAQ,GAAG,EAAjB;AAEAvB,EAAAA,SAAS,CAAC,YAAM;AACdK,IAAAA,QAAQ,CAACmB,IAAT,GAAgBC,kBAAhB,CAAmC,UAACC,OAAD,EAAa;AAC9C,UAAMC,SAAS,GAAG,EAAlB;AACAlB,MAAAA,GAAG,CACAmB,UADH,CACc,WADd,EAEGC,GAFH,GAGGC,IAHH,CAGQ,UAACC,QAAD,EAAc;AAClBA,QAAAA,QAAQ,CAACC,OAAT,CAAiB,UAACC,GAAD,EAAS;AACxB,cAAMC,QAAQ,GAAGD,GAAG,CAACE,IAAJ,EAAjB;AACAR,UAAAA,SAAS,CAACS,IAAV,CAAeF,QAAf;AACD,SAHD;AAIAP,QAAAA,SAAS,CAACK,OAAV,CAAkB,UAACK,OAAD,EAAa;AAC7B,cAAIA,OAAO,CAACC,OAAR,IAAmBZ,OAAO,CAACa,GAA/B,EAAoC;AAClCzB,YAAAA,OAAO,CAACY,OAAD,CAAP;AACD,WAFD,MAEO;AACLZ,YAAAA,OAAO,CAAC,IAAD,CAAP;AACD;AACF,SAND;AAOD,OAfH;AAgBD,KAlBD;AAmBD,GApBQ,EAoBN,EApBM,CAAT;AAsBAX,EAAAA,cAAc,CACZF,WAAW,CAAC,YAAM;AAChBM,IAAAA,EAAE,CAACqB,UAAH,CAAc,KAAd,EACGC,GADH,GAEGC,IAFH,CAEQ,UAACU,IAAD,EAAU;AACdtB,MAAAA,WAAW,CAACsB,IAAI,CAACC,IAAN,CAAX;AACD,KAJH;AAKA,QAAMC,SAAS,GAAG,EAAlB;AAEAnC,IAAAA,EAAE,CAACqB,UAAH,CAAc,KAAd,EACGe,OADH,CACW,UADX,EACuB,MADvB,EAEGC,KAFH,CAESrB,QAFT,EAGGM,GAHH,GAIGC,IAJH,CAIQ,UAACC,QAAD,EAAc;AAClBX,MAAAA,WAAW,CAACW,QAAQ,CAACc,IAAT,CAAcd,QAAQ,CAACc,IAAT,CAAcC,MAAd,GAAuB,CAArC,CAAD,CAAX;AAEAf,MAAAA,QAAQ,CAACC,OAAT,CAAiB,UAACC,GAAD,EAAS;AACxB,YAAMc,EAAE,GAAGd,GAAG,CAACE,IAAJ,EAAX;AACAY,QAAAA,EAAE,CAACC,EAAH,GAAQf,GAAG,CAACe,EAAZ;AACAN,QAAAA,SAAS,CAACN,IAAV,CAAeW,EAAf;AACD,OAJD;AAKA/B,MAAAA,MAAM,CAAC0B,SAAD,CAAN;AACD,KAbH;AAcD,GAtBU,EAsBR,EAtBQ,CADC,CAAd;;AA0BA,MAAMO,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC3B,QAAMP,SAAS,GAAG,EAAlB;AACA3B,IAAAA,GAAG,CAAC+B,MAAJ,GAAa7B,QAAb,IAAyBK,YAAY,CAAC,IAAD,CAArC;AAEAf,IAAAA,EAAE,CAACqB,UAAH,CAAc,KAAd,EACGe,OADH,CACW,UADX,EACuB,MADvB,EAEGO,UAFH,CAEc/B,QAAQ,CAACgB,IAAT,GAAgBgB,QAF9B,EAGGP,KAHH,CAGSrB,QAHT,EAIGM,GAJH,GAKGC,IALH,CAKQ,UAACC,QAAD,EAAc;AAClB,UAAIA,QAAQ,CAACc,IAAT,CAAcC,MAAd,GAAuB,CAA3B,EAA8B;AAC5B1B,QAAAA,WAAW,CAACW,QAAQ,CAACc,IAAT,CAAcd,QAAQ,CAACc,IAAT,CAAcC,MAAd,GAAuB,CAArC,CAAD,CAAX;AACD,OAFD,MAEO;AACLxB,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;;AAEDS,MAAAA,QAAQ,CAACC,OAAT,CAAiB,UAACC,GAAD,EAAS;AACxB,YAAMc,EAAE,GAAGd,GAAG,CAACE,IAAJ,EAAX;AACAY,QAAAA,EAAE,CAACC,EAAH,GAAQf,GAAG,CAACe,EAAZ;AACAN,QAAAA,SAAS,CAACN,IAAV,CAAeW,EAAf;AACD,OAJD;AAMA/B,MAAAA,MAAM,8BAAKD,GAAL,GAAa2B,SAAb,EAAN;AACD,KAnBH;AAoBD,GAxBD;;AA0BA,SACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEU,MAAM,CAACC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,OAAD;AACE,IAAA,GAAG,EAAEtC,GADP;AAEE,IAAA,cAAc,EAAEkC,cAFlB;AAGE,IAAA,SAAS,EAAE5B,SAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAOGR,IAAI,IACH,oBAAC,IAAD;AACE,IAAA,OAAO,MADT;AAEE,IAAA,IAAI,EAAC,oBAFP;AAGE,IAAA,IAAI,EAAC,MAHP;AAIE,IAAA,KAAK,EAAC,WAJR;AAKE,IAAA,cAAc,EAAEuC,MAAM,CAACE,YALzB;AAME,IAAA,OAAO,EAAE;AAAA,aAAM1C,UAAU,CAAC2C,QAAX,CAAoB,QAApB,CAAN;AAAA,KANX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARJ,CADF;AAoBD;AAED,IAAMH,MAAM,GAAGI,UAAU,CAACC,MAAX,CAAkB;AAC/BJ,EAAAA,QAAQ,EAAE;AACRK,IAAAA,IAAI,EAAE,CADE;AAERC,IAAAA,eAAe,EAAE;AAFT,GADqB;AAK/BL,EAAAA,YAAY,EAAE;AACZM,IAAAA,QAAQ,EAAE,UADE;AAEZC,IAAAA,MAAM,EAAE,EAFI;AAGZC,IAAAA,KAAK,EAAE,EAHK;AAIZC,IAAAA,WAAW,EAAE,OAJD;AAKZC,IAAAA,YAAY,EAAE;AAAEC,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,MAAM,EAAE;AAApB,KALF;AAMZC,IAAAA,aAAa,EAAE;AANH;AALiB,CAAlB,CAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { StyleSheet, View, Text } from \"react-native\";\r\nimport { Icon } from \"react-native-elements\";\r\nimport { useFocusEffect } from \"@react-navigation/native\";\r\nimport { firebaseApp } from \"../../utils/firebase\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport ListCds from \"../../components/Cds/ListCds\";\r\n\r\nconst db = firebase.firestore(firebaseApp);\r\nconst db1 = firebase.firestore(firebaseApp);\r\n\r\nexport default function Cds(props) {\r\n  const { navigation } = props;\r\n  const [user, setUser] = useState(null);\r\n  const [cds, setCds] = useState([]);\r\n  const [totalCds, settotalCds] = useState(0);\r\n  const [startCds, setStartCds] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const limitCds = 10;\r\n\r\n  useEffect(() => {\r\n    firebase.auth().onAuthStateChanged((useInfo) => {\r\n      const useradmin = [];\r\n      db1\r\n        .collection(\"useradmin\")\r\n        .get()\r\n        .then((response) => {\r\n          response.forEach((doc) => {\r\n            const usradmin = doc.data();\r\n            useradmin.push(usradmin);\r\n          });\r\n          useradmin.forEach((element) => {\r\n            if (element.useruid == useInfo.uid) {\r\n              setUser(useInfo);\r\n            } else {\r\n              setUser(null);\r\n            }\r\n          });\r\n        });\r\n    });\r\n  }, []);\r\n\r\n  useFocusEffect(\r\n    useCallback(() => {\r\n      db.collection(\"cds\")\r\n        .get()\r\n        .then((snap) => {\r\n          settotalCds(snap.size);\r\n        });\r\n      const resultCds = [];\r\n\r\n      db.collection(\"cds\")\r\n        .orderBy(\"createAt\", \"desc\")\r\n        .limit(limitCds)\r\n        .get()\r\n        .then((response) => {\r\n          setStartCds(response.docs[response.docs.length - 1]);\r\n\r\n          response.forEach((doc) => {\r\n            const cd = doc.data();\r\n            cd.id = doc.id;\r\n            resultCds.push(cd);\r\n          });\r\n          setCds(resultCds);\r\n        });\r\n    }, [])\r\n  );\r\n\r\n  const handleLoadMore = () => {\r\n    const resultCds = [];\r\n    cds.length < totalCds && setIsLoading(true);\r\n\r\n    db.collection(\"cds\")\r\n      .orderBy(\"createAt\", \"desc\")\r\n      .startAfter(startCds.data().createAt)\r\n      .limit(limitCds)\r\n      .get()\r\n      .then((response) => {\r\n        if (response.docs.length > 0) {\r\n          setStartCds(response.docs[response.docs.length - 1]);\r\n        } else {\r\n          setIsLoading(false);\r\n        }\r\n\r\n        response.forEach((doc) => {\r\n          const cd = doc.data();\r\n          cd.id = doc.id;\r\n          resultCds.push(cd);\r\n        });\r\n\r\n        setCds([...cds, ...resultCds]);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <View style={styles.viewBody}>\r\n      <ListCds\r\n        cds={cds}\r\n        handleLoadMore={handleLoadMore}\r\n        isLoading={isLoading}\r\n      />\r\n\r\n      {user && (\r\n        <Icon\r\n          reverse\r\n          type=\"material-community\"\r\n          name=\"plus\"\r\n          color=\"#ea4d14fa\"\r\n          containerStyle={styles.btnContainer}\r\n          onPress={() => navigation.navigate(\"add-cd\")}\r\n        />\r\n      )}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  viewBody: {\r\n    flex: 1,\r\n    backgroundColor: \"#fff\",\r\n  },\r\n  btnContainer: {\r\n    position: \"absolute\",\r\n    bottom: 10,\r\n    right: 10,\r\n    shadowColor: \"black\",\r\n    shadowOffset: { width: 4, height: 4 },\r\n    shadowOpacity: 0.2,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}